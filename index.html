<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø§Ø± Ø²Ø´ØªÙ‡ - Ø­Ø±Ú©Øª Ø¯Ø§Ø±Ù‡</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;user-select:none;-webkit-tap-highlight-color:transparent;}
        body{background:black;display:flex;justify-content:center;align-items:center;min-height:100dvh;font-family:system-ui;}
        .game{background:#0a0a0a;width:100%;max-width:500px;padding:10px;border:3px solid red;}
        .header{display:flex;justify-content:space-between;color:lime;padding:10px;background:#1a1a1a;margin-bottom:10px;}
        canvas{background:#111;width:100%;aspect-ratio:1;border:2px solid yellow;display:block;}
        .buttons{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:15px;}
        .btn{background:#333;color:white;font-size:35px;padding:20px;border:3px solid cyan;border-radius:0;font-weight:bold;}
        .btn:active{background:red;transform:scale(0.9);}
        .big{grid-column:span 2;background:purple;font-size:25px;}
        .status{color:yellow;text-align:center;padding:10px;background:navy;margin-top:10px;font-size:20px;}
    </style>
</head>
<body>
<div class="game">
    <div class="header">
        <span>ğŸ <span id="score">0</span></span>
        <span>ğŸ† <span id="highScore">0</span></span>
    </div>
    
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    
    <div id="status" class="status">ğŸ‘‰ Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø±Ùˆ Ø¨Ø²Ù†</div>
    
    <div class="buttons">
        <button class="btn" id="up">â¬†ï¸</button>
        <button class="btn" id="left">â¬…ï¸</button>
        <button class="btn" id="down">â¬‡ï¸</button>
        <button class="btn" id="right">â¡ï¸</button>
        <button class="btn" id="pause">â¸ï¸</button>
        <button class="btn big" id="restart">ğŸ”„ Ø´Ø±ÙˆØ¹</button>
    </div>
</div>

<script>
    (function(){
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let scoreEl = document.getElementById('score');
        let highScoreEl = document.getElementById('highScore');
        let statusEl = document.getElementById('status');
        
        let grid = 20;
        let tile = canvas.width / grid;
        
        let snake = [{x:10, y:10}];
        let dir = {x:0, y:0};
        let food = {x:15, y:15};
        let score = 0;
        let high = localStorage.getItem('snake') || 0;
        highScoreEl.innerText = high;
        
        let gameLoop = null;
        let running = false;
        let paused = false;
        let speed = 120;
        
        function makeFood(){
            let ok = false;
            while(!ok){
                ok = true;
                food = {
                    x: Math.floor(Math.random() * grid),
                    y: Math.floor(Math.random() * grid)
                };
                for(let s of snake){
                    if(s.x === food.x && s.y === food.y){
                        ok = false;
                        break;
                    }
                }
            }
        }
        makeFood();
        
        function draw(){
            ctx.fillStyle = '#111';
            ctx.fillRect(0,0,canvas.width,canvas.height);
            
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 0.5;
            for(let i=0;i<=grid;i++){
                ctx.beginPath();
                ctx.moveTo(i*tile,0);
                ctx.lineTo(i*tile,canvas.height);
                ctx.stroke();
                ctx.moveTo(0,i*tile);
                ctx.lineTo(canvas.width,i*tile);
                ctx.stroke();
            }
            
            for(let i=0;i<snake.length;i++){
                ctx.fillStyle = i===0 ? '#0f0' : '#0a0';
                ctx.fillRect(snake[i].x*tile+1, snake[i].y*tile+1, tile-2, tile-2);
                if(i===0){
                    ctx.fillStyle = '#fff';
                    ctx.fillRect(snake[i].x*tile+3, snake[i].y*tile+3, 3, 3);
                    ctx.fillRect(snake[i].x*tile+12, snake[i].y*tile+3, 3, 3);
                    ctx.fillStyle = '#000';
                    ctx.fillRect(snake[i].x*tile+4, snake[i].y*tile+4, 2, 2);
                    ctx.fillRect(snake[i].x*tile+13, snake[i].y*tile+4, 2, 2);
                }
            }
            
            ctx.fillStyle = '#f00';
            ctx.beginPath();
            ctx.arc(food.x*tile+tile/2, food.y*tile+tile/2, tile/2-2, 0, 2*Math.PI);
            ctx.fill();
            ctx.fillStyle = '#0f0';
            ctx.beginPath();
            ctx.arc(food.x*tile+5, food.y*tile+5, 3, 0, 2*Math.PI);
            ctx.fill();
        }
        draw();
        
        function move(){
            if(!running || paused) return;
            if(dir.x === 0 && dir.y === 0) return;
            
            let head = {
                x: snake[0].x + dir.x,
                y: snake[0].y + dir.y
            };
            
            if(head.x < 0 || head.x >= grid || head.y < 0 || head.y >= grid){
                gameOver();
                return;
            }
            
            for(let s of snake){
                if(head.x === s.x && head.y === s.y){
                    gameOver();
                    return;
                }
            }
            
            snake.unshift(head);
            
            if(head.x === food.x && head.y === food.y){
                score += 10;
                scoreEl.innerText = score;
                makeFood();
                if(score > high){
                    high = score;
                    localStorage.setItem('snake', high);
                    highScoreEl.innerText = high;
                }
                if(score % 30 === 0 && speed > 50){
                    speed -= 10;
                    resetInterval();
                }
            } else {
                snake.pop();
            }
            
            draw();
        }
        
        function resetInterval(){
            if(gameLoop) clearInterval(gameLoop);
            if(running && !paused){
                gameLoop = setInterval(move, speed);
            }
        }
        
        function gameOver(){
            running = false;
            paused = false;
            clearInterval(gameLoop);
            gameLoop = null;
            statusEl.innerText = 'ğŸ’€ Ù…Ø±Ø¯ÛŒ! Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø±Ùˆ Ø¨Ø²Ù†';
        }
        
        function restart(){
            snake = [{x:10, y:10}];
            dir = {x:1, y:0};  // â˜…â˜…â˜…â˜…â˜… Ù…Ù‡Ù…: Ø¬Ù‡Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ù‡ Ø±Ø§Ø³Øª
            score = 0;
            speed = 120;
            scoreEl.innerText = '0';
            running = true;
            paused = false;
            makeFood();
            clearInterval(gameLoop);
            gameLoop = setInterval(move, speed);
            statusEl.innerText = 'ğŸ® Ø¯Ø§Ø±Ù‡ Ù…ÛŒØ±Ù‡ ...';
            draw();
        }
        
        function pauseGame(){
            if(!running) return;
            paused = !paused;
            if(paused){
                clearInterval(gameLoop);
                gameLoop = null;
                statusEl.innerText = 'â¸ï¸ Ù…Ú©Ø«';
            } else {
                gameLoop = setInterval(move, speed);
                statusEl.innerText = 'ğŸ® Ø¯Ø§Ø±Ù‡ Ù…ÛŒØ±Ù‡ ...';
            }
        }
        
        // Ú©Ù†ØªØ±Ù„ Ø¨Ø§ Ø¯Ú©Ù…Ù‡
        document.getElementById('up').addEventListener('click', ()=>{
            if(!running || paused) return;
            if(dir.y === 0) dir = {x:0, y:-1};
        });
        document.getElementById('down').addEventListener('click', ()=>{
            if(!running || paused) return;
            if(dir.y === 0) dir = {x:0, y:1};
        });
        document.getElementById('left').addEventListener('click', ()=>{
            if(!running || paused) return;
            if(dir.x === 0) dir = {x:-1, y:0};
        });
        document.getElementById('right').addEventListener('click', ()=>{
            if(!running || paused) return;
            if(dir.x === 0) dir = {x:1, y:0};
        });
        document.getElementById('restart').addEventListener('click', restart);
        document.getElementById('pause').addEventListener('click', pauseGame);
        
        // Ú©Ù†ØªØ±Ù„ Ø¨Ø§ Ú©ÛŒØ¨ÙˆØ±Ø¯
        window.addEventListener('keydown', (e)=>{
            if(!running || paused) return;
            switch(e.key){
                case 'ArrowUp': e.preventDefault(); if(dir.y===0) dir={x:0,y:-1}; break;
                case 'ArrowDown': e.preventDefault(); if(dir.y===0) dir={x:0,y:1}; break;
                case 'ArrowLeft': e.preventDefault(); if(dir.x===0) dir={x:-1,y:0}; break;
                case 'ArrowRight': e.preventDefault(); if(dir.x===0) dir={x:1,y:0}; break;
                case ' ': e.preventDefault(); pauseGame(); break;
            }
        });
        
        document.querySelectorAll('button').forEach(b=>{
            b.addEventListener('touchstart', e=>e.preventDefault());
        });
        
        // â˜…â˜…â˜…â˜…â˜… Ø¨Ø§Ø²ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªØŒ ÙÙ‚Ø· Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø±Ùˆ Ø¨Ø²Ù†
        draw();
        statusEl.innerText = 'ğŸ‘† Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ Ø±Ùˆ Ø¨Ø²Ù†';
    })();
</script>
</body>
</html>
